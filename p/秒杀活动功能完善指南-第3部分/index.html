<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="è¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªé«˜å¹¶å‘çš„ç§’æ€æ´»åŠ¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬é˜²è¶…å–ã€åˆ†å¸ƒå¼é”ã€Redisç¼“å­˜ç­‰æ ¸å¿ƒæŠ€æœ¯å®ç°ã€‚"><title>ç§’æ€æ´»åŠ¨åŠŸèƒ½å®Œå–„æŒ‡å— - ç¬¬3éƒ¨åˆ†</title><link rel=canonical href=https://Yin123-ybh.github.io/p/%E7%A7%92%E6%9D%80%E6%B4%BB%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84%E6%8C%87%E5%8D%97-%E7%AC%AC3%E9%83%A8%E5%88%86/><link rel=stylesheet href=/scss/style.min.946cca6c6259ef94ac55abfae7c7bf3291ea3ed5eea17ef77500b257217c6710.css><meta property='og:title' content="ç§’æ€æ´»åŠ¨åŠŸèƒ½å®Œå–„æŒ‡å— - ç¬¬3éƒ¨åˆ†"><meta property='og:description' content="è¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªé«˜å¹¶å‘çš„ç§’æ€æ´»åŠ¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬é˜²è¶…å–ã€åˆ†å¸ƒå¼é”ã€Redisç¼“å­˜ç­‰æ ¸å¿ƒæŠ€æœ¯å®ç°ã€‚"><meta property='og:url' content='https://Yin123-ybh.github.io/p/%E7%A7%92%E6%9D%80%E6%B4%BB%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84%E6%8C%87%E5%8D%97-%E7%AC%AC3%E9%83%A8%E5%88%86/'><meta property='og:site_name' content='Cecilia-å¡è¥¿è‰å¨…'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='Java'><meta property='article:tag' content='Spring Boot'><meta property='article:tag' content='Redis'><meta property='article:tag' content='é«˜å¹¶å‘'><meta property='article:tag' content='ç§’æ€ç³»ç»Ÿ'><meta property='article:published_time' content='2025-01-12T00:00:00+00:00'><meta property='article:modified_time' content='2025-01-12T00:00:00+00:00'><meta name=twitter:title content="ç§’æ€æ´»åŠ¨åŠŸèƒ½å®Œå–„æŒ‡å— - ç¬¬3éƒ¨åˆ†"><meta name=twitter:description content="è¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªé«˜å¹¶å‘çš„ç§’æ€æ´»åŠ¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬é˜²è¶…å–ã€åˆ†å¸ƒå¼é”ã€Redisç¼“å­˜ç­‰æ ¸å¿ƒæŠ€æœ¯å®ç°ã€‚"><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_8636e4c1b17bd1a4.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ§‘â€ğŸ’»</span></figure><div class=site-meta><h1 class=site-name><a href=/>Cecilia-å¡è¥¿è‰å¨…</a></h1><h2 class=site-description>Welcome to my website</h2></div></header><ol class=menu-social><li><a href=https://github.com/Yin123-ybh target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://Yin123-ybh.github.io/ selected>English</option><option value=https://Yin123-ybh.github.io/zh-cn/>ç®€ä½“ä¸­æ–‡</option><option value=https://Yin123-ybh.github.io/ar/>Ø¹Ø±Ø¨ÙŠ</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-ä¸ºä»€ä¹ˆéœ€è¦å¯é‡å…¥é”>1. ä¸ºä»€ä¹ˆéœ€è¦å¯é‡å…¥é”ï¼Ÿ</a></li><li><a href=#2-æ™®é€šåˆ†å¸ƒå¼é”çš„é—®é¢˜>2. æ™®é€šåˆ†å¸ƒå¼é”çš„é—®é¢˜</a><ol><li><a href=#é—®é¢˜å‡ºåœ¨å“ªé‡Œ>é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ</a></li></ol></li><li><a href=#3-redisson-çš„æ”¹è¿›å¯é‡å…¥å®ç°>3. Redisson çš„æ”¹è¿›ï¼ˆå¯é‡å…¥å®ç°ï¼‰</a></li><li><a href=#4-æ‰§è¡Œæµç¨‹ä¸¾ä¾‹>4. æ‰§è¡Œæµç¨‹ä¸¾ä¾‹</a><ol><li><a href=#41-ç¬¬ä¸€æ¬¡åŠ é”methoda>4.1 ç¬¬ä¸€æ¬¡åŠ é”ï¼ˆmethodAï¼‰</a></li><li><a href=#42-ç¬¬äºŒæ¬¡åŠ é”methodb>4.2 ç¬¬äºŒæ¬¡åŠ é”ï¼ˆmethodBï¼‰</a></li><li><a href=#43-methodb-æ‰§è¡Œå®Œé‡Šæ”¾é”>4.3 methodB æ‰§è¡Œå®Œé‡Šæ”¾é”</a></li><li><a href=#44-methoda-æ‰§è¡Œå®Œé‡Šæ”¾é”>4.4 methodA æ‰§è¡Œå®Œé‡Šæ”¾é”</a></li></ol></li><li><a href=#5-é€šä¿—è§£é‡Š>5. é€šä¿—è§£é‡Š</a></li><li><a href=#6-æ ¸å¿ƒå®ç°åŸç†>6. æ ¸å¿ƒå®ç°åŸç†</a><ol><li><a href=#61-åŠ é”æµç¨‹>6.1 åŠ é”æµç¨‹</a></li><li><a href=#62-é‡Šæ”¾é”æµç¨‹>6.2 é‡Šæ”¾é”æµç¨‹</a></li></ol></li><li><a href=#7-å…³é”®ç‰¹æ€§>7. å…³é”®ç‰¹æ€§</a><ol><li><a href=#71-çº¿ç¨‹å®‰å…¨>7.1 çº¿ç¨‹å®‰å…¨</a></li><li><a href=#72-è‡ªåŠ¨ç»­æœŸ>7.2 è‡ªåŠ¨ç»­æœŸ</a></li><li><a href=#73-å…¬å¹³æ€§>7.3 å…¬å¹³æ€§</a></li><li><a href=#74-å¯é‡å…¥æ€§>7.4 å¯é‡å…¥æ€§</a></li></ol></li><li><a href=#8-ä½¿ç”¨ç¤ºä¾‹>8. ä½¿ç”¨ç¤ºä¾‹</a></li><li><a href=#9-æ€»ç»“å‡å>9. æ€»ç»“å‡å</a><ol><li><a href=#ä¸€å¥è¯æ€»ç»“>ä¸€å¥è¯æ€»ç»“ï¼š</a></li></ol></li><li><a href=#10-æ‰©å±•é˜…è¯»>10. æ‰©å±•é˜…è¯»</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/web%E5%BC%80%E5%8F%91/>Webå¼€å‘</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E7%A7%92%E6%9D%80%E6%B4%BB%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84%E6%8C%87%E5%8D%97-%E7%AC%AC3%E9%83%A8%E5%88%86/>ç§’æ€æ´»åŠ¨åŠŸèƒ½å®Œå–„æŒ‡å— - ç¬¬3éƒ¨åˆ†</a></h2><h3 class=article-subtitle>è¯¦ç»†ä»‹ç»å¦‚ä½•ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ªé«˜å¹¶å‘çš„ç§’æ€æ´»åŠ¨ç³»ç»Ÿï¼ŒåŒ…æ‹¬é˜²è¶…å–ã€åˆ†å¸ƒå¼é”ã€Redisç¼“å­˜ç­‰æ ¸å¿ƒæŠ€æœ¯å®ç°ã€‚</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025-01-12</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h1 id=redisson-å¯é‡å…¥é”åŸç†è¯¦è§£>Redisson å¯é‡å…¥é”åŸç†è¯¦è§£</h1><h2 id=1-ä¸ºä»€ä¹ˆéœ€è¦å¯é‡å…¥é”>1. ä¸ºä»€ä¹ˆéœ€è¦å¯é‡å…¥é”ï¼Ÿ</h2><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œ<strong>é”</strong> æ˜¯ä¿è¯çº¿ç¨‹å®‰å…¨çš„é‡è¦æ‰‹æ®µã€‚ä½†æœ‰æ—¶å€™ï¼Œä¸€ä¸ªçº¿ç¨‹åœ¨æŒæœ‰é”æ—¶ï¼Œä¼šè°ƒç”¨å¦ä¸€ä¸ªä¹Ÿéœ€è¦åŒä¸€æŠŠé”çš„æ–¹æ³•ï¼Œè¿™æ—¶é—®é¢˜å°±æ¥äº†ï¼š</p><ul><li>å¦‚æœé” <strong>ä¸å¯é‡å…¥</strong>ï¼Œçº¿ç¨‹åœ¨ç¬¬äºŒæ¬¡å°è¯•åŠ é”æ—¶ä¼šå¤±è´¥ï¼Œå› ä¸ºé”å·²ç»å­˜åœ¨ï¼Œå®ƒç›¸å½“äº <strong>æŠŠè‡ªå·±å¡æ­»äº†</strong>ã€‚</li><li>å¦‚æœé” <strong>å¯é‡å…¥</strong>ï¼ŒåŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å–è¿™æŠŠé”ï¼Œç›´åˆ°æœ€åé‡Šæ”¾æ—¶æ‰çœŸæ­£è§£é”ã€‚</li></ul><p>æ‰€ä»¥ï¼Œå¯é‡å…¥é”çš„æ„ä¹‰åœ¨äºï¼š<strong>é¿å…åŒä¸€çº¿ç¨‹å› ä¸ºæ–¹æ³•åµŒå¥—è°ƒç”¨è€Œæ­»é”</strong>ã€‚</p><hr><h2 id=2-æ™®é€šåˆ†å¸ƒå¼é”çš„é—®é¢˜>2. æ™®é€šåˆ†å¸ƒå¼é”çš„é—®é¢˜</h2><p>æœ€ç®€å•çš„åˆ†å¸ƒå¼é”é€šå¸¸ç”¨ Redis çš„ <code>SETNX</code> å®ç°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>SET key value NX EX 30
</span></span></code></pre></td></tr></table></div></div><ul><li><code>NX</code> è¡¨ç¤ºå¦‚æœ key ä¸å­˜åœ¨æ‰è®¾ç½®ï¼Œä¿è¯åŸå­æ€§ã€‚</li><li><code>EX 30</code> è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œé˜²æ­¢æ­»é”ã€‚</li></ul><h3 id=é—®é¢˜å‡ºåœ¨å“ªé‡Œ>é—®é¢˜å‡ºåœ¨å“ªé‡Œï¼Ÿ</h3><p>å½“ä¸€ä¸ªçº¿ç¨‹å·²ç»æŒæœ‰é”æ—¶ï¼Œå¦‚æœåœ¨æ–¹æ³•åµŒå¥—ä¸­å†æ¬¡å°è¯•è·å–é”ï¼š</p><ol><li>Redis å‘ç° key å·²å­˜åœ¨ï¼Œç›´æ¥è¿”å›å¤±è´¥ã€‚</li><li>è™½ç„¶æ˜¯ <strong>åŒä¸€ä¸ªçº¿ç¨‹</strong> æƒ³å†æ¬¡è·å–é”ï¼Œä½†å› ä¸ºé”å®ç°é‡ŒåªåŒºåˆ† &ldquo;æœ‰é” / æ— é”&rdquo;ï¼Œå¹¶ä¸ä¼šè¯†åˆ«çº¿ç¨‹ã€‚</li><li>ç»“æœå°±æ˜¯ï¼š<strong>è‡ªå·±æŠŠè‡ªå·±é”æ­»äº†</strong>ã€‚</li></ol><hr><h2 id=3-redisson-çš„æ”¹è¿›å¯é‡å…¥å®ç°>3. Redisson çš„æ”¹è¿›ï¼ˆå¯é‡å…¥å®ç°ï¼‰</h2><p>Redisson åœ¨ value çš„å­˜å‚¨ä¸Šåšäº†æ”¹è¿›ï¼Œå®ƒå¹¶ä¸æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ä¸€ä¸ª <strong>Hash ç»“æ„</strong>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lockKey -&gt; {
</span></span><span class=line><span class=cl>   threadId : reentrantCount
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>threadId</strong>ï¼šå”¯ä¸€æ ‡è¯†æŸä¸ª JVM é‡Œçš„æŸä¸ªçº¿ç¨‹ï¼ˆä¸€èˆ¬æ˜¯ UUID:threadIdï¼‰ã€‚</li><li><strong>reentrantCount</strong>ï¼šè®°å½•è¿™ä¸ªçº¿ç¨‹æŒæœ‰é”çš„æ¬¡æ•°ã€‚</li></ul><p>è¿™æ ·å°±å¯ä»¥æ”¯æŒ <strong>å¯é‡å…¥</strong> äº†ã€‚</p><hr><h2 id=4-æ‰§è¡Œæµç¨‹ä¸¾ä¾‹>4. æ‰§è¡Œæµç¨‹ä¸¾ä¾‹</h2><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>methodA</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>lock</span><span class=p>.</span><span class=na>lock</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>methodB</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>lock</span><span class=p>.</span><span class=na>unlock</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>methodB</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>lock</span><span class=p>.</span><span class=na>lock</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// æ‰§è¡Œé€»è¾‘</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>lock</span><span class=p>.</span><span class=na>unlock</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=41-ç¬¬ä¸€æ¬¡åŠ é”methoda>4.1 ç¬¬ä¸€æ¬¡åŠ é”ï¼ˆmethodAï¼‰</h3><ul><li>Redis é‡Œè¿˜æ²¡æœ‰ <code>lockKey</code>ã€‚</li><li>Redisson ä¼šå†™å…¥ï¼š<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lockKey -&gt; { &#34;UUID:thread-1&#34; : 1 }
</span></span></code></pre></td></tr></table></div></div></li><li>è¡¨ç¤ºçº¿ç¨‹ <code>thread-1</code> ç¬¬ä¸€æ¬¡è·å–é”ï¼Œé‡å…¥æ¬¡æ•° = 1ã€‚</li></ul><h3 id=42-ç¬¬äºŒæ¬¡åŠ é”methodb>4.2 ç¬¬äºŒæ¬¡åŠ é”ï¼ˆmethodBï¼‰</h3><ul><li>Redis å‘ç° <code>lockKey</code> å·²å­˜åœ¨ï¼Œä½† owner æ˜¯ <strong>åŒä¸€ä¸ªçº¿ç¨‹</strong>ã€‚</li><li>å…è®¸é‡å…¥ï¼Œè®¡æ•° +1ï¼š<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lockKey -&gt; { &#34;UUID:thread-1&#34; : 2 }
</span></span></code></pre></td></tr></table></div></div></li></ul><h3 id=43-methodb-æ‰§è¡Œå®Œé‡Šæ”¾é”>4.3 methodB æ‰§è¡Œå®Œé‡Šæ”¾é”</h3><ul><li>è°ƒç”¨ <code>unlock()</code>ï¼Œè®¡æ•° -1ï¼š<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lockKey -&gt; { &#34;UUID:thread-1&#34; : 1 }
</span></span></code></pre></td></tr></table></div></div></li><li>é”ä»ç„¶ç”±å½“å‰çº¿ç¨‹æŒæœ‰ã€‚</li></ul><h3 id=44-methoda-æ‰§è¡Œå®Œé‡Šæ”¾é”>4.4 methodA æ‰§è¡Œå®Œé‡Šæ”¾é”</h3><ul><li>å†æ¬¡è°ƒç”¨ <code>unlock()</code>ï¼Œè®¡æ•° -1 â†’ å˜æˆ 0ã€‚</li><li>Redisson åˆ é™¤ <code>lockKey</code>ï¼š<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lockKey åˆ é™¤
</span></span></code></pre></td></tr></table></div></div></li><li>æ­¤æ—¶é”æ‰çœŸæ­£é‡Šæ”¾ï¼Œå…¶ä»–çº¿ç¨‹æ‰æœ‰æœºä¼šè·å–ã€‚</li></ul><hr><h2 id=5-é€šä¿—è§£é‡Š>5. é€šä¿—è§£é‡Š</h2><p>ä½ æ€»ç»“å¾—éå¸¸åˆ°ä½ï¼Œå¯ä»¥ç”¨é€šä¿—çš„è¯å†æè¿°ä¸€æ¬¡ï¼š</p><p>å‡å¦‚ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨å¤šä¸ªæ–¹æ³•æ—¶ï¼Œç¬¬ä¸€ä¸ªæ–¹æ³•ç”¨äº†é”å»è°ƒç”¨ç¬¬äºŒä¸ªæ–¹æ³•ï¼Œç¬¬äºŒä¸ªæ–¹æ³•å†æ¬¡è°ƒç”¨è¿™ä¸ªçº¿ç¨‹çš„é”å°±ä¼šå¤±è´¥ã€‚å› ä¸ºè™½ç„¶é”çš„ key ä¸€æ ·ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡è·å–é”çš„æ—¶å€™ä¼šå‘ç°é”å·²ç»å­˜åœ¨äº†ï¼Œå°±è·å–å¤±è´¥ã€‚</p><p>Redisson åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåšäº†æ”¹è¿›ï¼šå®ƒåœ¨é”çš„ value é‡ŒåŠ ä¸Šäº†ä¸€ä¸ª <strong>é‡å…¥æ¬¡æ•°</strong>ï¼Œå¹¶åˆ©ç”¨ Redis Hash ç»“æ„æ¥å­˜å‚¨ã€‚</p><p>Hash ç»“æ„é‡Œæœ‰ä¸¤ä¸ªå€¼ï¼š</p><ul><li><strong>field</strong>ï¼šå½“å‰çº¿ç¨‹çš„æ ‡è¯†ï¼ˆUUID + threadIdï¼‰</li><li><strong>value</strong>ï¼šé‡å…¥æ¬¡æ•°</li></ul><p>æ‰§è¡Œè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li><strong>æ–¹æ³•ä¸€ç¬¬ä¸€æ¬¡è·å–é”</strong>ï¼šé‡å…¥æ¬¡æ•° +1ï¼Œå˜æˆ 1</li><li><strong>æ–¹æ³•ä¸€è°ƒç”¨æ–¹æ³•äºŒï¼Œæ–¹æ³•äºŒåˆè¦ç”¨é”</strong>ï¼šé‡å…¥æ¬¡æ•°å† +1ï¼Œå˜æˆ 2</li><li><strong>æ–¹æ³•äºŒæ‰§è¡Œå®Œé‡Šæ”¾é”</strong>ï¼šé‡å…¥æ¬¡æ•° -1ï¼Œå˜å› 1</li><li><strong>æ–¹æ³•ä¸€æ‰§è¡Œå®Œé‡Šæ”¾é”</strong>ï¼šé‡å…¥æ¬¡æ•° -1ï¼Œå˜å› 0ï¼Œé”æ‰çœŸæ­£é‡Šæ”¾</li></ol><p>è¿™æ ·å°±é¿å…äº†åŒä¸€ä¸ªçº¿ç¨‹å› ä¸ºåµŒå¥—è°ƒç”¨è€Œæ­»é”ã€‚</p><hr><h2 id=6-æ ¸å¿ƒå®ç°åŸç†>6. æ ¸å¿ƒå®ç°åŸç†</h2><h3 id=61-åŠ é”æµç¨‹>6.1 åŠ é”æµç¨‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=c1>-- åŠ é”è„šæœ¬</span>
</span></span><span class=line><span class=cl><span class=kr>if</span> <span class=p>(</span><span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;exists&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;hset&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;pexpire&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=kc>nil</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>end</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>if</span> <span class=p>(</span><span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;hexists&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;hincrby&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;pexpire&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=kc>nil</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>end</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>return</span> <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;pttl&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=62-é‡Šæ”¾é”æµç¨‹>6.2 é‡Šæ”¾é”æµç¨‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-lua data-lang=lua><span class=line><span class=cl><span class=c1>-- é‡Šæ”¾é”è„šæœ¬</span>
</span></span><span class=line><span class=cl><span class=kr>if</span> <span class=p>(</span><span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;hexists&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=kc>nil</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>end</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>local</span> <span class=n>counter</span> <span class=o>=</span> <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;hincrby&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>3</span><span class=p>],</span> <span class=o>-</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>if</span> <span class=p>(</span><span class=n>counter</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=kr>then</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;pexpire&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>2</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>else</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;del&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=n>redis.call</span><span class=p>(</span><span class=s1>&#39;publish&#39;</span><span class=p>,</span> <span class=n>KEYS</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=n>ARGV</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>end</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=7-å…³é”®ç‰¹æ€§>7. å…³é”®ç‰¹æ€§</h2><h3 id=71-çº¿ç¨‹å®‰å…¨>7.1 çº¿ç¨‹å®‰å…¨</h3><ul><li>ä½¿ç”¨ Lua è„šæœ¬ä¿è¯åŸå­æ€§</li><li>é¿å…ç«æ€æ¡ä»¶</li></ul><h3 id=72-è‡ªåŠ¨ç»­æœŸ>7.2 è‡ªåŠ¨ç»­æœŸ</h3><ul><li>é€šè¿‡ <code>pexpire</code> è‡ªåŠ¨ç»­æœŸ</li><li>é˜²æ­¢ä¸šåŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿å¯¼è‡´é”è¿‡æœŸ</li></ul><h3 id=73-å…¬å¹³æ€§>7.3 å…¬å¹³æ€§</h3><ul><li>æ”¯æŒå…¬å¹³é”å’Œéå…¬å¹³é”</li><li>é€šè¿‡é˜Ÿåˆ—æœºåˆ¶ä¿è¯è·å–é”çš„é¡ºåº</li></ul><h3 id=74-å¯é‡å…¥æ€§>7.4 å¯é‡å…¥æ€§</h3><ul><li>åŒä¸€çº¿ç¨‹å¯å¤šæ¬¡è·å–é”</li><li>é€šè¿‡é‡å…¥è®¡æ•°å™¨å®ç°</li></ul><hr><h2 id=8-ä½¿ç”¨ç¤ºä¾‹>8. ä½¿ç”¨ç¤ºä¾‹</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// è·å–å¯é‡å…¥é”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>RLock</span><span class=w> </span><span class=n>lock</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>redisson</span><span class=p>.</span><span class=na>getLock</span><span class=p>(</span><span class=s>&#34;myLock&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// å°è¯•åŠ é”ï¼Œæœ€å¤šç­‰å¾…100ç§’ï¼Œä¸Šé”ä»¥å10ç§’è‡ªåŠ¨è§£é”</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kt>boolean</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>lock</span><span class=p>.</span><span class=na>tryLock</span><span class=p>(</span><span class=n>100</span><span class=p>,</span><span class=w> </span><span class=n>10</span><span class=p>,</span><span class=w> </span><span class=n>TimeUnit</span><span class=p>.</span><span class=na>SECONDS</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>res</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// ä¸šåŠ¡é€»è¾‘</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>doSomething</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>finally</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>lock</span><span class=p>.</span><span class=na>unlock</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>InterruptedException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>e</span><span class=p>.</span><span class=na>printStackTrace</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><hr><h2 id=9-æ€»ç»“å‡å>9. æ€»ç»“å‡å</h2><ol><li><p><strong>æ™®é€šåˆ†å¸ƒå¼é”</strong>åªå…³å¿ƒ &ldquo;æœ‰é” / æ— é”&rdquo;ï¼Œä¸å…³å¿ƒæ˜¯è°åŠ çš„é”ï¼Œå¯¼è‡´ <strong>åŒä¸€çº¿ç¨‹é‡å…¥æ—¶ä¹Ÿä¼šå¤±è´¥</strong>ã€‚</p></li><li><p><strong>Redisson</strong> é€šè¿‡åœ¨ Redis çš„ Hash ç»“æ„ ä¸­è®°å½• &ldquo;çº¿ç¨‹æ ‡è¯† + é‡å…¥è®¡æ•°&rdquo;ï¼Œè®©é”å…·å¤‡äº† <strong>å¯é‡å…¥èƒ½åŠ›</strong>ã€‚</p></li><li><p><strong>æ„ä¹‰</strong>ï¼šå¯é‡å…¥é”é¿å…äº†ä¸€ä¸ªçº¿ç¨‹åœ¨åµŒå¥—è°ƒç”¨ä¸­æŠŠè‡ªå·±å¡æ­»ï¼ŒåŒæ—¶å¯¹å¤–ä»ç„¶ä¿æŒåˆ†å¸ƒå¼é”çš„ç‰¹æ€§ã€‚</p></li></ol><h3 id=ä¸€å¥è¯æ€»ç»“>ä¸€å¥è¯æ€»ç»“ï¼š</h3><blockquote><p><strong>Redisson çš„å¯é‡å…¥é”ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ç”¨ Redis Hash å­˜å‚¨çº¿ç¨‹ ID å’Œé‡å…¥æ¬¡æ•°ï¼Œç›´åˆ°é‡å…¥æ¬¡æ•°å½’é›¶æ‰çœŸæ­£é‡Šæ”¾é”ã€‚</strong></p></blockquote><hr><h2 id=10-æ‰©å±•é˜…è¯»>10. æ‰©å±•é˜…è¯»</h2><ul><li><a class=link href=https://github.com/redisson/redisson target=_blank rel=noopener>Redisson å®˜æ–¹æ–‡æ¡£</a></li><li><a class=link href=https://redis.io/docs/manual/patterns/distributed-locks/ target=_blank rel=noopener>Redis åˆ†å¸ƒå¼é”æœ€ä½³å®è·µ</a></li><li><a class=link href=https://book.douban.com/subject/10484692/ target=_blank rel=noopener>Java å¹¶å‘ç¼–ç¨‹å®æˆ˜</a></li></ul><hr><p><em>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº† Redisson å¯é‡å…¥é”çš„å®ç°åŸç†ï¼Œå¸®åŠ©å¼€å‘è€…æ·±å…¥ç†è§£åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒæœºåˆ¶ã€‚</em></p></section><footer class=article-footer><section class=article-tags><a href=/tags/java/>Java</a>
<a href=/tags/spring-boot/>Spring Boot</a>
<a href=/tags/redis/>Redis</a>
<a href=/tags/%E9%AB%98%E5%B9%B6%E5%8F%91/>é«˜å¹¶å‘</a>
<a href=/tags/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/>ç§’æ€ç³»ç»Ÿ</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E7%A7%92%E6%9D%80%E6%B4%BB%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84%E6%8C%87%E5%8D%97-%E7%AC%AC%E4%B8%80%E9%83%A8%E5%88%86/><div class=article-details><h2 class=article-title>ç§’æ€æ´»åŠ¨åŠŸèƒ½å®Œå–„æŒ‡å— - ç¬¬ä¸€éƒ¨åˆ†</h2></div></a></article><article><a href=/p/%E7%A7%92%E6%9D%80%E6%B4%BB%E5%8A%A8%E5%8A%9F%E8%83%BD%E5%AE%8C%E5%96%84%E6%8C%87%E5%8D%97-%E7%AC%AC%E4%BA%8C%E9%83%A8%E5%88%86/><div class=article-details><h2 class=article-title>ç§’æ€æ´»åŠ¨åŠŸèƒ½å®Œå–„æŒ‡å— - ç¬¬äºŒéƒ¨åˆ†</h2></div></a></article><article><a href=/p/%E5%9F%BA%E4%BA%8E-session-%E7%9A%84%E7%9F%AD%E4%BF%A1%E7%99%BB%E5%BD%95%E5%AE%8C%E6%95%B4%E8%A7%A3%E6%9E%90/><div class=article-details><h2 class=article-title>åŸºäº Session çš„çŸ­ä¿¡ç™»å½•å®Œæ•´è§£æ</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2025 Cecilia-å¡è¥¿è‰å¨…</section><section class=powerby>Never give up<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>